(this.webpackJsonpsqlclient=this.webpackJsonpsqlclient||[]).push([[6],{154:function(t,e,n){"use strict";var r=n(2),a=n(40),o=n(0),i=n(56),c=n(224),u=n(176),s=n(127),l=n(140),d=Object(s.a)((function(t){return Object(l.a)({textFieldInput:{width:"90%",marginTop:20},button:{backgroundColor:t.palette.secondary.main,marginTop:10},container:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",marginTop:10,marginBottom:-5,width:"85%"}})})),b=function(t){return 6===t.length&&/^[0-9]+$/.test(t)},f=n(41),j=n(42);e.a=function(){var t=d(),e=Object(o.useState)(""),n=Object(a.a)(e,2),s=n[0],l=n[1],p=Object(o.useContext)(f.a).dispatch;return Object(r.jsxs)("div",{className:t.container,children:[Object(r.jsx)(c.a,{value:s,variant:"outlined",label:"Voting code (6 digits)",placeholder:"Type the 6-digit code here",onChange:function(t){l(t.target.value)},className:t.textFieldInput,id:"code-textfield"}),b(s)&&Object(r.jsx)(u.a,{onClick:function(){p({type:j.a.SET_VOTING_NUMBER,data:s})},className:t.button,id:"fetchData-button",children:Object(r.jsx)(i.a,{children:"GET VOTING"})})]})}},155:function(t,e,n){"use strict";n.d(e,"a",(function(){return k}));var r=n(145),a=n.n(r),o=n(146),i=n(40),c=n(0),u=n(42),s=n(150),l=n.n(s),d="http://localhost:3001";d="https://lotsofdotsserver.herokuapp.com";var b=function(){var t=Object(o.a)(a.a.mark((function t(e){var n;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,l.a.get("".concat(d,"/votings/").concat(e));case 3:return n=t.sent,t.abrupt("return",f(n.data));case 7:return t.prev=7,t.t0=t.catch(0),t.abrupt("return",void 0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}(),f=function(t){var e=t;return{question:v(e.question),votingNumber:m(e.voting_number),showNames:O(e.show_names),allowedCount:h(e.allowed_count),created:x(e.created),optionVotes:g(e.option_votes)}},j=function(t){return"string"===typeof t||t instanceof String},p=function(t){return"number"===typeof t||t instanceof Number},v=function(t){if(!t||!j(t))throw new Error("Question is required and must be string!");return t},m=function(t){if(!t||!j(t))throw new Error("Voting number is required and must be string!");return t},O=function(t){if(void 0===t||null===t||!("boolean"===typeof(e=t)||e instanceof Boolean))throw new Error("Show names is required and must be a boolean value!");var e;return t},h=function(t){if(!t||!p(t))throw new Error("Allowed count is required and must be a number!");return t},x=function(t){if(!t||!j(t))throw new Error("Date is required and must be string!");return t},g=function(t){if(!t||!Array.isArray(t))throw new Error("Options are required and must be an array of option data!");return t.map((function(t){return w(t)}))},w=function(t){var e=t;return{id:y(e.id),optionText:T(e.option_text),optionVoters:N(e.option_voters)}},y=function(t){if(!t||!p(t))throw new Error("Option Id is required and must be a number!");return t},T=function(t){if(!t||!j(t))throw new Error("Option text is required and must be string!");return t},N=function(t){if(!t||!Array)throw new Error("Option voters are required and must be an array of string or null!");return 1===t.length&&null===t[0]?[]:E(t)},C=function(t){return t.every((function(t){return null===t}))},E=function(t){if(!C(t)&&!function(t){return t.every((function(t){return j(t)}))}(t))throw new Error("Option voters are required and must be an array of string or null!");return C(t),t},V=n(41),k=function(){var t=Object(c.useState)(!1),e=Object(i.a)(t,2),n=e[0],r=e[1],s=Object(c.useContext)(V.a),l=s.state,d=s.dispatch;return Object(c.useEffect)((function(){function t(){return(t=Object(o.a)(a.a.mark((function t(){var e;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===l.votingNumber){t.next=5;break}return t.next=3,b(l.votingNumber);case 3:void 0!==(e=t.sent)?d({type:u.a.SET_VOTING_DATA,data:e}):r(!0);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[]),{errorInGettingData:n}}},156:function(t,e,n){"use strict";var r=n(2),a=(n(0),n(56)),o=n(127),i=n(140),c=Object(o.a)((function(t){return Object(i.a)({container:{marginTop:40},text:{color:t.palette.error.main,textAlign:"center",marginTop:10}})}));e.a=function(t){var e=t.votingNumber,n=c();return Object(r.jsxs)("div",{className:n.container,children:[Object(r.jsx)(a.a,{variant:"h6",className:n.text,children:"Voting number"}),Object(r.jsx)(a.a,{variant:"h4",className:n.text,children:Object(r.jsx)("strong",{children:e})}),Object(r.jsx)(a.a,{variant:"h6",className:n.text,children:"Could not find that voting!"})]})}},225:function(t,e,n){"use strict";n.r(e);var r=n(2),a=n(0),o=n(154),i=n(41),c=n(40),u=n(155),s=n(156),l=n(56),d=n(224),b=n(176),f=n(127),j=n(140),p=Object(f.a)((function(t){return Object(j.a)({textFieldInput:{width:"90%",marginTop:20},button:{backgroundColor:t.palette.secondary.main,marginTop:10},container:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",marginTop:30,marginBottom:-5,width:"85%"},instructionText:{textAlign:"center"}})})),v=function(t){var e=t.setVoterName,n=p(),o=Object(a.useState)(""),i=Object(c.a)(o,2),u=i[0],s=i[1];return Object(r.jsxs)("div",{className:n.container,children:[Object(r.jsx)(l.a,{className:n.instructionText,children:"Please give your name."}),Object(r.jsx)(l.a,{children:"(Note that others will see how you voted.)"}),Object(r.jsx)(d.a,{value:u,variant:"outlined",label:"Your name",placeholder:"Type your name here",onChange:function(t){s(t.target.value)},className:n.textFieldInput,id:"name-textfield"}),u.length>3&&Object(r.jsx)(b.a,{onClick:function(){e(u)},className:n.button,id:"fetchData-button",children:Object(r.jsx)(l.a,{children:"SAVE NAME"})})]})},m=n(145),O=n.n(m),h=n(146),x=n(19),g=Object(f.a)((function(t){return Object(j.a)({optionText:{textAlign:"center",marginTop:20},buttonsContainer:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center"},unvoteButton:{backgroundColor:t.palette.primary.main,color:t.palette.primary.contrastText,marginLeft:3,height:25},voteButton:{backgroundColor:t.palette.secondary.light,color:t.palette.secondary.contrastText,marginLeft:3,height:25}})})),w=function(t){var e=t.id,n=t.optionText,a=t.votes,o=t.changeSelection,i=t.remaining,c=t.votingDone,u=g(),s=function(t,n){t.preventDefault(),o(e,n)};return Object(r.jsxs)("div",{children:[Object(r.jsx)(l.a,{variant:"h6",className:u.optionText,children:n}),Object(r.jsxs)("div",{className:u.buttonsContainer,children:[new Array(a).fill(q.UNVOTE).map((function(t,n){return Object(r.jsx)(b.a,{onClick:function(e){return s(e,t)},className:u.unvoteButton,disabled:c,children:t},n+e+"unvote")})),new Array(i).fill(q.VOTE).map((function(t,n){return Object(r.jsx)(b.a,{onClick:function(e){return s(e,t)},className:u.voteButton,disabled:c,children:t},n+e+"vote")}))]})]})},y=n(150),T=n.n(y),N="http://localhost:3001";N="https://lotsofdotsserver.herokuapp.com";var C,E=function(){var t=Object(h.a)(O.a.mark((function t(e){return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,T.a.post("".concat(N,"/answers"),e);case 3:return t.abrupt("return",!0);case 6:return t.prev=6,t.t0=t.catch(0),t.abrupt("return",!1);case 9:case"end":return t.stop()}}),t,null,[[0,6]])})));return function(e){return t.apply(this,arguments)}}(),V=Object(f.a)((function(t){return Object(j.a)({questionText:{textAlign:"center",marginTop:20},submitButtonContainer:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",marginTop:40},submitButton:{backgroundColor:t.palette.primary.dark},submitButtonText:{color:t.palette.primary.contrastText},linkText:{color:t.palette.primary.main}})})),k=n(231),S=n(227),D=function(t){var e=t.alert;return Object(r.jsx)(k.a,{id:"snackbar-alert",open:e.isOpen,autoHideDuration:e.autoHideDuration,onClose:e.onClose,children:Object(r.jsx)(S.a,{variant:"filled",severity:e.severity,onClose:e.onClose,id:"alert-".concat(e.severity),children:e.message})})};!function(t){t.ERROR="error",t.WARNING="warning",t.SUCCESS="success"}(C||(C={}));var q,A=n(34);!function(t){t.VOTE="VOTE",t.UNVOTE="UNVOTE"}(q||(q={}));var I=function(t){var e=t.voterName,n=V(),o=Object(a.useContext)(i.a).state,u=Object(a.useState)(o.votingData),s=Object(c.a)(u,1)[0],d=Object(a.useState)(!1),f=Object(c.a)(d,2),j=f[0],p=f[1],v=Object(a.useState)(function(t){if(t){var e={};return t.optionVotes.forEach((function(t){e[t.id]=0})),e}}(o.votingData)),m=Object(c.a)(v,2),g=m[0],y=m[1],T=Object(a.useState)(void 0),N=Object(c.a)(T,2),k=N[0],S=N[1];if(!s||!g)return null;var I=function(t,e){var n=s.optionVotes.reduce((function(t,e){return t+g[e.id]}),0);if(e===q.VOTE&&n<s.allowedCount){var r=Object(x.a)({},g);r[t]=g[t]+1,y(r)}else if(g[t]>0){var a=Object(x.a)({},g);a[t]=g[t]-1,y(a)}},B=function(){for(var t=[],e=0,n=Object.entries(g);e<n.length;e++){var r=Object(c.a)(n[e],2),a=r[0],o=r[1],i=new Array(o).fill(parseInt(a));t=t.concat(i)}return t},_=function(){var t=Object(h.a)(O.a.mark((function t(){var n,r,a;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={name:e,answers:B()},t.next=3,E(n);case 3:t.sent?(r={isOpen:!0,severity:C.SUCCESS,message:"Votes successfully saved!",onClose:function(){return S(void 0)},autoHideDuration:5e3},S(r),p(!0)):(a={isOpen:!0,severity:C.ERROR,message:"Could not submit votes!",onClose:function(){return S(void 0)},autoHideDuration:5e3},S(a));case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),R=s.optionVotes.reduce((function(t,e){return t+g[e.id]}),0),G=s.allowedCount-R;return Object(r.jsxs)("div",{children:[Object(r.jsx)(l.a,{variant:"h5",className:n.questionText,children:Object(r.jsx)("strong",{children:s.question})}),s.optionVotes.map((function(t){return Object(r.jsx)(w,{id:t.id,optionText:t.optionText,changeSelection:I,votes:g[t.id],remaining:G,votingDone:j},t.optionText)})),Object(r.jsxs)("div",{className:n.submitButtonContainer,children:[!j&&R>0&&Object(r.jsx)(b.a,{onClick:_,variant:"contained",className:n.submitButton,children:Object(r.jsx)(l.a,{className:n.submitButtonText,children:"SUBMIT VOTES"})}),j&&Object(r.jsx)(l.a,{children:Object(r.jsx)(A.b,{to:"/view",className:n.linkText,children:"View current voting situation"})})]}),k&&Object(r.jsx)(D,{alert:k})]})},B=function(){var t=Object(a.useState)(void 0),e=Object(c.a)(t,2),n=e[0],o=e[1],l=Object(a.useContext)(i.a).state,d=Object(u.a)().errorInGettingData;return l.votingNumber?d?Object(r.jsx)(s.a,{votingNumber:l.votingNumber}):l.votingData?l.votingData.showNames&&!n?Object(r.jsx)(v,{setVoterName:o}):Object(r.jsx)(I,{voterName:n}):null:null},_=Object(f.a)((function(t){return Object(j.a)({text:{textAlign:"center",marginTop:20,color:t.palette.primary.dark}})}));e.default=function(){var t=Object(a.useContext)(i.a).state,e=_();return Object(r.jsxs)("div",{children:[Object(r.jsx)(l.a,{variant:"h5",className:e.text,children:Object(r.jsx)("strong",{children:"VOTE"})}),void 0===t.votingNumber?Object(r.jsx)(o.a,{}):Object(r.jsx)(B,{})]})}}}]);
//# sourceMappingURL=6.be7127c4.chunk.js.map