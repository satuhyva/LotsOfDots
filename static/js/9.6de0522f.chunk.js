(this.webpackJsonpsqlclient=this.webpackJsonpsqlclient||[]).push([[9],{223:function(t,e,n){"use strict";n.r(e);var r=n(2),o=n(0),a=n(40),i=n(56),c=n(222),u=n(173),s=n(127),l=n(140),d=Object(s.a)((function(t){return Object(l.a)({textFieldInput:{width:"90%",marginTop:20},button:{backgroundColor:t.palette.secondary.main,marginTop:10},container:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",marginTop:10,marginBottom:-5,width:"85%"}})})),b=function(t){return 6===t.length&&/^[0-9]+$/.test(t)},f=n(41),p=n(44),j=function(){var t=d(),e=Object(o.useState)(""),n=Object(a.a)(e,2),s=n[0],l=n[1],j=Object(o.useContext)(f.a).dispatch;return Object(r.jsxs)("div",{className:t.container,children:[Object(r.jsx)(c.a,{value:s,variant:"outlined",label:"Voting code (6 digits)",placeholder:"Type the 6-digit code here",onChange:function(t){l(t.target.value)},className:t.textFieldInput,id:"code-textfield"}),b(s)&&Object(r.jsx)(u.a,{onClick:function(){j({type:p.a.SET_VOTING_NUMBER,data:s})},className:t.button,id:"fetchData-button",children:Object(r.jsx)(i.a,{children:"GET VOTING"})})]})},v=n(145),m=n.n(v),h=n(146),O=n(153),x=n.n(O),g="http://localhost:3001";g="https://lotsofdotsserver.herokuapp.com";var w=function(){var t=Object(h.a)(m.a.mark((function t(e){var n;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,x.a.get("".concat(g,"/votings/").concat(e));case 3:return n=t.sent,console.log("******"),console.log(n.data),t.abrupt("return",y(n.data));case 9:return t.prev=9,t.t0=t.catch(0),console.log(t.t0),console.log(t.t0.toString()),t.abrupt("return",void 0);case 14:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}(),y=function(t){var e=t;return{question:C(e.question),votingNumber:E(e.voting_number),showNames:V(e.show_names),allowedCount:S(e.allowed_count),created:k(e.created),optionVotes:D(e.option_votes)}},T=function(t){return"string"===typeof t||t instanceof String},N=function(t){return"number"===typeof t||t instanceof Number},C=function(t){if(!t||!T(t))throw new Error("Question is required and must be string!");return t},E=function(t){if(!t||!T(t))throw new Error("Voting number is required and must be string!");return t},V=function(t){if(void 0===t||null===t||!("boolean"===typeof(e=t)||e instanceof Boolean))throw new Error("Show names is required and must be a boolean value!");var e;return t},S=function(t){if(!t||!N(t))throw new Error("Allowed count is required and must be a number!");return t},k=function(t){if(!t||!T(t))throw new Error("Date is required and must be string!");return t},D=function(t){if(!t||!Array.isArray(t))throw new Error("Options are required and must be an array of option data!");return t.map((function(t){return q(t)}))},q=function(t){var e=t;return{id:I(e.id),optionText:A(e.option_text),optionVoters:B(e.option_voters)}},I=function(t){if(!t||!N(t))throw new Error("Option Id is required and must be a number!");return t},A=function(t){if(!t||!T(t))throw new Error("Option text is required and must be string!");return t},B=function(t){if(!t||!Array)throw new Error("Option voters are required and must be an array of string or null!");return 1===t.length&&null===t[0]?[]:R(t)},_=function(t){return t.every((function(t){return null===t}))},R=function(t){if(!_(t)&&!function(t){return t.every((function(t){return T(t)}))}(t))throw new Error("Option voters are required and must be an array of string or null!");return _(t),t},G=Object(s.a)((function(t){return Object(l.a)({container:{marginTop:40},text:{color:t.palette.error.main,textAlign:"center",marginTop:10}})})),U=function(t){var e=t.votingNumber,n=G();return Object(r.jsxs)("div",{className:n.container,children:[Object(r.jsx)(i.a,{variant:"h6",className:n.text,children:"Voting number"}),Object(r.jsx)(i.a,{variant:"h4",className:n.text,children:Object(r.jsx)("strong",{children:e})}),Object(r.jsx)(i.a,{variant:"h6",className:n.text,children:"Could not find that voting!"})]})},F=Object(s.a)((function(t){return Object(l.a)({textFieldInput:{width:"90%",marginTop:20},button:{backgroundColor:t.palette.secondary.main,marginTop:10},container:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",marginTop:30,marginBottom:-5,width:"85%"},instructionText:{textAlign:"center"}})})),H=function(t){var e=t.setVoterName,n=F(),s=Object(o.useState)(""),l=Object(a.a)(s,2),d=l[0],b=l[1];return Object(r.jsxs)("div",{className:n.container,children:[Object(r.jsx)(i.a,{className:n.instructionText,children:"Please give your name."}),Object(r.jsx)(i.a,{children:"(Note that others will see how you voted.)"}),Object(r.jsx)(c.a,{value:d,variant:"outlined",label:"Your name",placeholder:"Type your name here",onChange:function(t){b(t.target.value)},className:n.textFieldInput,id:"name-textfield"}),d.length>3&&Object(r.jsx)(u.a,{onClick:function(){e(d)},className:n.button,id:"fetchData-button",children:Object(r.jsx)(i.a,{children:"SAVE NAME"})})]})},M=n(19),J=Object(s.a)((function(t){return Object(l.a)({optionText:{textAlign:"center",marginTop:20},buttonsContainer:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center"},unvoteButton:{backgroundColor:t.palette.primary.main,color:t.palette.primary.contrastText,marginLeft:3,height:25},voteButton:{backgroundColor:t.palette.secondary.light,color:t.palette.secondary.contrastText,marginLeft:3,height:25}})})),L=function(t){var e=t.id,n=t.optionText,o=t.votes,a=t.changeSelection,c=t.remaining,s=t.votingDone,l=J(),d=function(t,n){t.preventDefault(),a(e,n)};return Object(r.jsxs)("div",{children:[Object(r.jsx)(i.a,{variant:"h6",className:l.optionText,children:n}),Object(r.jsxs)("div",{className:l.buttonsContainer,children:[new Array(o).fill(X.UNVOTE).map((function(t,n){return Object(r.jsx)(u.a,{onClick:function(e){return d(e,t)},className:l.unvoteButton,disabled:s,children:t},n+e+"unvote")})),new Array(c).fill(X.VOTE).map((function(t,n){return Object(r.jsx)(u.a,{onClick:function(e){return d(e,t)},className:l.voteButton,disabled:s,children:t},n+e+"vote")}))]})]})},P="http://localhost:3001";P="https://lotsofdotsserver.herokuapp.com";var Q,W=function(){var t=Object(h.a)(m.a.mark((function t(e){return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,x.a.post("".concat(P,"/answers"),e);case 3:return t.abrupt("return",!0);case 6:return t.prev=6,t.t0=t.catch(0),t.abrupt("return",!1);case 9:case"end":return t.stop()}}),t,null,[[0,6]])})));return function(e){return t.apply(this,arguments)}}(),Y=Object(s.a)((function(t){return Object(l.a)({questionText:{textAlign:"center",marginTop:20},submitButtonContainer:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",marginTop:40},submitButton:{backgroundColor:t.palette.primary.dark},submitButtonText:{color:t.palette.primary.contrastText},linkText:{color:t.palette.primary.main}})})),$=n(228),z=n(225),K=function(t){var e=t.alert;return Object(r.jsx)($.a,{id:"snackbar-alert",open:e.isOpen,autoHideDuration:e.autoHideDuration,onClose:e.onClose,children:Object(r.jsx)(z.a,{variant:"filled",severity:e.severity,onClose:e.onClose,id:"alert-".concat(e.severity),children:e.message})})};!function(t){t.ERROR="error",t.WARNING="warning",t.SUCCESS="success"}(Q||(Q={}));var X,Z=n(34);!function(t){t.VOTE="VOTE",t.UNVOTE="UNVOTE"}(X||(X={}));var tt=function(t){var e=t.voterName,n=Y(),c=Object(o.useContext)(f.a).state,s=Object(o.useState)(c.votingData),l=Object(a.a)(s,1)[0],d=Object(o.useState)(!1),b=Object(a.a)(d,2),p=b[0],j=b[1],v=Object(o.useState)(function(t){if(t){var e={};return t.optionVotes.forEach((function(t){e[t.id]=0})),e}}(c.votingData)),O=Object(a.a)(v,2),x=O[0],g=O[1],w=Object(o.useState)(void 0),y=Object(a.a)(w,2),T=y[0],N=y[1];if(!l||!x)return null;var C=function(t,e){var n=l.optionVotes.reduce((function(t,e){return t+x[e.id]}),0);if(e===X.VOTE&&n<l.allowedCount){var r=Object(M.a)({},x);r[t]=x[t]+1,g(r)}else if(x[t]>0){var o=Object(M.a)({},x);o[t]=x[t]-1,g(o)}},E=function(){for(var t=[],e=0,n=Object.entries(x);e<n.length;e++){var r=Object(a.a)(n[e],2),o=r[0],i=r[1],c=new Array(i).fill(parseInt(o));t=t.concat(c)}return t},V=function(){var t=Object(h.a)(m.a.mark((function t(){var n,r,o;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={name:e,answers:E()},t.next=3,W(n);case 3:t.sent?(r={isOpen:!0,severity:Q.SUCCESS,message:"Votes successfully saved!",onClose:function(){return N(void 0)},autoHideDuration:5e3},N(r),j(!0)):(o={isOpen:!0,severity:Q.ERROR,message:"Could not submit votes!",onClose:function(){return N(void 0)},autoHideDuration:5e3},N(o));case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),S=l.optionVotes.reduce((function(t,e){return t+x[e.id]}),0),k=l.allowedCount-S;return Object(r.jsxs)("div",{children:[Object(r.jsx)(i.a,{variant:"h5",className:n.questionText,children:Object(r.jsx)("strong",{children:l.question})}),l.optionVotes.map((function(t){return Object(r.jsx)(L,{id:t.id,optionText:t.optionText,changeSelection:C,votes:x[t.id],remaining:k,votingDone:p},t.optionText)})),Object(r.jsxs)("div",{className:n.submitButtonContainer,children:[!p&&S>0&&Object(r.jsx)(u.a,{onClick:V,variant:"contained",className:n.submitButton,children:Object(r.jsx)(i.a,{className:n.submitButtonText,children:"SUBMIT VOTES"})}),p&&Object(r.jsx)(i.a,{children:Object(r.jsx)(Z.b,{to:"/view",className:n.linkText,children:"View current voting situation"})})]}),T&&Object(r.jsx)(K,{alert:T})]})},et=function(){var t=Object(o.useState)(void 0),e=Object(a.a)(t,2),n=e[0],i=e[1],c=Object(o.useContext)(f.a).state,u=function(){var t=Object(o.useState)(!1),e=Object(a.a)(t,2),n=e[0],r=e[1],i=Object(o.useContext)(f.a),c=i.state,u=i.dispatch;return Object(o.useEffect)((function(){function t(){return(t=Object(h.a)(m.a.mark((function t(){var e;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===c.votingNumber){t.next=5;break}return t.next=3,w(c.votingNumber);case 3:void 0!==(e=t.sent)?u({type:p.a.SET_VOTING_DATA,data:e}):r(!0);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[]),{errorInGettingData:n}}().errorInGettingData;return c.votingNumber?u?Object(r.jsx)(U,{votingNumber:c.votingNumber}):c.votingData?c.votingData.showNames&&!n?Object(r.jsx)(H,{setVoterName:i}):Object(r.jsx)(tt,{voterName:n}):null:null};e.default=function(){var t=Object(o.useContext)(f.a).state;return Object(r.jsx)("div",{children:void 0===t.votingNumber?Object(r.jsx)(j,{}):Object(r.jsx)(et,{})})}}}]);
//# sourceMappingURL=9.6de0522f.chunk.js.map